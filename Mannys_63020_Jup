{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Project 1\n",
    "\n",
    "## The Plan...\n",
    "\n",
    "1. Import the file MTA data\n",
    "2. Clean the data so that the entries and exits represent the commulative data for the day and not since the machine was made. \n",
    "3. Identify the top 10 entry times and locations (sort by entries)\n",
    "3. Calculate and sort the accumulated sums by station"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 1. Importing the MTA file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_csv('http://web.mta.info/developers/data/nyct/turnstile/turnstile_200627.txt')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['C/A', 'UNIT', 'SCP', 'STATION', 'LINENAME', 'DIVISION', 'DATE', 'TIME',\n",
       "       'DESC', 'ENTRIES',\n",
       "       'EXITS                                                               '],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.columns"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "For some reason EXIT has a weird column heading. I had a very hard time accessing the column...\n",
    "\n",
    "### 2. Cleaning the table"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['C/A', 'UNIT', 'SCP', 'STATION', 'LINENAME', 'DIVISION', 'DATE', 'TIME',\n",
       "       'DESC', 'ENTRIES', 'EXITS'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# question: for some reason \"inplace=True\" wasnt working. I had to create a new df\n",
    "\n",
    "df = df.rename({'EXITS                                                               ': 'EXITS'}, axis=1)\n",
    "df.columns"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Jonathan's code: "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "## gets the number of entries and exits\n",
    "mta_entries = df.groupby(['STATION','C/A','UNIT','SCP','DATE']).ENTRIES.max() - df.groupby(['STATION','C/A','UNIT','SCP','DATE' ]).ENTRIES.min()\n",
    "mta_exits = df.groupby(['STATION','C/A','UNIT','SCP','DATE']).EXITS.max() - df.groupby(['STATION','C/A','UNIT','SCP','DATE' ]).EXITS.min()\n",
    "\n",
    "## flattens the data\n",
    "mta_entries_flat = mta_entries.reset_index()\n",
    "mta_exits_flat = mta_exits.reset_index()\n",
    "mta_entries_exits = pd.merge(mta_entries_flat, mta_exits_flat, how='outer')\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>STATION</th>\n",
       "      <th>C/A</th>\n",
       "      <th>UNIT</th>\n",
       "      <th>SCP</th>\n",
       "      <th>DATE</th>\n",
       "      <th>ENTRIES</th>\n",
       "      <th>EXITS</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1 AV</td>\n",
       "      <td>H007</td>\n",
       "      <td>R248</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/20/2020</td>\n",
       "      <td>0</td>\n",
       "      <td>451</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1 AV</td>\n",
       "      <td>H007</td>\n",
       "      <td>R248</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/21/2020</td>\n",
       "      <td>0</td>\n",
       "      <td>340</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1 AV</td>\n",
       "      <td>H007</td>\n",
       "      <td>R248</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/22/2020</td>\n",
       "      <td>0</td>\n",
       "      <td>837</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1 AV</td>\n",
       "      <td>H007</td>\n",
       "      <td>R248</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/23/2020</td>\n",
       "      <td>0</td>\n",
       "      <td>860</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1 AV</td>\n",
       "      <td>H007</td>\n",
       "      <td>R248</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/24/2020</td>\n",
       "      <td>0</td>\n",
       "      <td>879</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>1 AV</td>\n",
       "      <td>H007</td>\n",
       "      <td>R248</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/25/2020</td>\n",
       "      <td>0</td>\n",
       "      <td>919</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1 AV</td>\n",
       "      <td>H007</td>\n",
       "      <td>R248</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/26/2020</td>\n",
       "      <td>0</td>\n",
       "      <td>910</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1 AV</td>\n",
       "      <td>H007</td>\n",
       "      <td>R248</td>\n",
       "      <td>00-00-01</td>\n",
       "      <td>06/20/2020</td>\n",
       "      <td>190</td>\n",
       "      <td>264</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>1 AV</td>\n",
       "      <td>H007</td>\n",
       "      <td>R248</td>\n",
       "      <td>00-00-01</td>\n",
       "      <td>06/21/2020</td>\n",
       "      <td>150</td>\n",
       "      <td>223</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>1 AV</td>\n",
       "      <td>H007</td>\n",
       "      <td>R248</td>\n",
       "      <td>00-00-01</td>\n",
       "      <td>06/22/2020</td>\n",
       "      <td>369</td>\n",
       "      <td>578</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  STATION   C/A  UNIT       SCP        DATE  ENTRIES  EXITS\n",
       "0    1 AV  H007  R248  00-00-00  06/20/2020        0    451\n",
       "1    1 AV  H007  R248  00-00-00  06/21/2020        0    340\n",
       "2    1 AV  H007  R248  00-00-00  06/22/2020        0    837\n",
       "3    1 AV  H007  R248  00-00-00  06/23/2020        0    860\n",
       "4    1 AV  H007  R248  00-00-00  06/24/2020        0    879\n",
       "5    1 AV  H007  R248  00-00-00  06/25/2020        0    919\n",
       "6    1 AV  H007  R248  00-00-00  06/26/2020        0    910\n",
       "7    1 AV  H007  R248  00-00-01  06/20/2020      190    264\n",
       "8    1 AV  H007  R248  00-00-01  06/21/2020      150    223\n",
       "9    1 AV  H007  R248  00-00-01  06/22/2020      369    578"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mta_entries_exits.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 3. Identifying top 10 locations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>STATION</th>\n",
       "      <th>C/A</th>\n",
       "      <th>UNIT</th>\n",
       "      <th>SCP</th>\n",
       "      <th>DATE</th>\n",
       "      <th>ENTRIES</th>\n",
       "      <th>EXITS</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2424</th>\n",
       "      <td>161/YANKEE STAD</td>\n",
       "      <td>N203</td>\n",
       "      <td>R195</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/22/2020</td>\n",
       "      <td>1627398252</td>\n",
       "      <td>1627443437</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12921</th>\n",
       "      <td>96 ST-2 AVE</td>\n",
       "      <td>N702</td>\n",
       "      <td>R572</td>\n",
       "      <td>00-00-03</td>\n",
       "      <td>06/26/2020</td>\n",
       "      <td>651514335</td>\n",
       "      <td>65268530</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13278</th>\n",
       "      <td>ASTORIA BLVD</td>\n",
       "      <td>R514</td>\n",
       "      <td>R094</td>\n",
       "      <td>00-00-04</td>\n",
       "      <td>06/26/2020</td>\n",
       "      <td>15683282</td>\n",
       "      <td>3597243</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14529</th>\n",
       "      <td>BAY PKWY</td>\n",
       "      <td>E014</td>\n",
       "      <td>R374</td>\n",
       "      <td>00-00-02</td>\n",
       "      <td>06/20/2020</td>\n",
       "      <td>8360109</td>\n",
       "      <td>10927655</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16230</th>\n",
       "      <td>BROADWAY</td>\n",
       "      <td>R512</td>\n",
       "      <td>R092</td>\n",
       "      <td>00-03-00</td>\n",
       "      <td>06/21/2020</td>\n",
       "      <td>6666009</td>\n",
       "      <td>850516</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26363</th>\n",
       "      <td>LAFAYETTE AV</td>\n",
       "      <td>N110</td>\n",
       "      <td>R283</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/25/2020</td>\n",
       "      <td>2393128</td>\n",
       "      <td>1578146</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2557</th>\n",
       "      <td>161/YANKEE STAD</td>\n",
       "      <td>R262</td>\n",
       "      <td>R195</td>\n",
       "      <td>03-00-02</td>\n",
       "      <td>06/22/2020</td>\n",
       "      <td>1004107</td>\n",
       "      <td>499126</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14336</th>\n",
       "      <td>B'WAY-LAFAYETTE</td>\n",
       "      <td>N519</td>\n",
       "      <td>R461</td>\n",
       "      <td>00-03-03</td>\n",
       "      <td>06/23/2020</td>\n",
       "      <td>920129</td>\n",
       "      <td>1416</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>550</th>\n",
       "      <td>116 ST</td>\n",
       "      <td>N030</td>\n",
       "      <td>R333</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/24/2020</td>\n",
       "      <td>621120</td>\n",
       "      <td>560803</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28116</th>\n",
       "      <td>NEVINS ST</td>\n",
       "      <td>R608</td>\n",
       "      <td>R056</td>\n",
       "      <td>00-00-01</td>\n",
       "      <td>06/21/2020</td>\n",
       "      <td>517614</td>\n",
       "      <td>285851</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32674</th>\n",
       "      <td>TREMONT AV</td>\n",
       "      <td>N213</td>\n",
       "      <td>R154</td>\n",
       "      <td>00-00-01</td>\n",
       "      <td>06/26/2020</td>\n",
       "      <td>499454</td>\n",
       "      <td>487242</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14397</th>\n",
       "      <td>B'WAY-LAFAYETTE</td>\n",
       "      <td>N519A</td>\n",
       "      <td>R461</td>\n",
       "      <td>01-05-01</td>\n",
       "      <td>06/21/2020</td>\n",
       "      <td>262144</td>\n",
       "      <td>65454</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32750</th>\n",
       "      <td>TWENTY THIRD ST</td>\n",
       "      <td>PTH12</td>\n",
       "      <td>R542</td>\n",
       "      <td>00-00-03</td>\n",
       "      <td>06/25/2020</td>\n",
       "      <td>125234</td>\n",
       "      <td>7592</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25464</th>\n",
       "      <td>JOURNAL SQUARE</td>\n",
       "      <td>PTH03</td>\n",
       "      <td>R552</td>\n",
       "      <td>00-01-08</td>\n",
       "      <td>06/22/2020</td>\n",
       "      <td>39253</td>\n",
       "      <td>29853</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5122</th>\n",
       "      <td>3 AV-149 ST</td>\n",
       "      <td>R310</td>\n",
       "      <td>R053</td>\n",
       "      <td>01-00-00</td>\n",
       "      <td>06/25/2020</td>\n",
       "      <td>1691</td>\n",
       "      <td>236</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24662</th>\n",
       "      <td>JAMAICA CENTER</td>\n",
       "      <td>N606</td>\n",
       "      <td>R025</td>\n",
       "      <td>00-00-07</td>\n",
       "      <td>06/25/2020</td>\n",
       "      <td>1679</td>\n",
       "      <td>360</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24660</th>\n",
       "      <td>JAMAICA CENTER</td>\n",
       "      <td>N606</td>\n",
       "      <td>R025</td>\n",
       "      <td>00-00-07</td>\n",
       "      <td>06/23/2020</td>\n",
       "      <td>1678</td>\n",
       "      <td>335</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29344</th>\n",
       "      <td>PARKCHESTER</td>\n",
       "      <td>R417</td>\n",
       "      <td>R222</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/25/2020</td>\n",
       "      <td>1673</td>\n",
       "      <td>108</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24663</th>\n",
       "      <td>JAMAICA CENTER</td>\n",
       "      <td>N606</td>\n",
       "      <td>R025</td>\n",
       "      <td>00-00-07</td>\n",
       "      <td>06/26/2020</td>\n",
       "      <td>1642</td>\n",
       "      <td>381</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1766</th>\n",
       "      <td>14 ST-UNION SQ</td>\n",
       "      <td>A034</td>\n",
       "      <td>R170</td>\n",
       "      <td>03-03-02</td>\n",
       "      <td>06/22/2020</td>\n",
       "      <td>1627</td>\n",
       "      <td>212</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               STATION    C/A  UNIT       SCP        DATE     ENTRIES  \\\n",
       "2424   161/YANKEE STAD   N203  R195  00-00-00  06/22/2020  1627398252   \n",
       "12921      96 ST-2 AVE   N702  R572  00-00-03  06/26/2020   651514335   \n",
       "13278     ASTORIA BLVD   R514  R094  00-00-04  06/26/2020    15683282   \n",
       "14529         BAY PKWY   E014  R374  00-00-02  06/20/2020     8360109   \n",
       "16230         BROADWAY   R512  R092  00-03-00  06/21/2020     6666009   \n",
       "26363     LAFAYETTE AV   N110  R283  00-00-00  06/25/2020     2393128   \n",
       "2557   161/YANKEE STAD   R262  R195  03-00-02  06/22/2020     1004107   \n",
       "14336  B'WAY-LAFAYETTE   N519  R461  00-03-03  06/23/2020      920129   \n",
       "550             116 ST   N030  R333  00-00-00  06/24/2020      621120   \n",
       "28116        NEVINS ST   R608  R056  00-00-01  06/21/2020      517614   \n",
       "32674       TREMONT AV   N213  R154  00-00-01  06/26/2020      499454   \n",
       "14397  B'WAY-LAFAYETTE  N519A  R461  01-05-01  06/21/2020      262144   \n",
       "32750  TWENTY THIRD ST  PTH12  R542  00-00-03  06/25/2020      125234   \n",
       "25464   JOURNAL SQUARE  PTH03  R552  00-01-08  06/22/2020       39253   \n",
       "5122       3 AV-149 ST   R310  R053  01-00-00  06/25/2020        1691   \n",
       "24662   JAMAICA CENTER   N606  R025  00-00-07  06/25/2020        1679   \n",
       "24660   JAMAICA CENTER   N606  R025  00-00-07  06/23/2020        1678   \n",
       "29344      PARKCHESTER   R417  R222  00-00-00  06/25/2020        1673   \n",
       "24663   JAMAICA CENTER   N606  R025  00-00-07  06/26/2020        1642   \n",
       "1766    14 ST-UNION SQ   A034  R170  03-03-02  06/22/2020        1627   \n",
       "\n",
       "            EXITS  \n",
       "2424   1627443437  \n",
       "12921    65268530  \n",
       "13278     3597243  \n",
       "14529    10927655  \n",
       "16230      850516  \n",
       "26363     1578146  \n",
       "2557       499126  \n",
       "14336        1416  \n",
       "550        560803  \n",
       "28116      285851  \n",
       "32674      487242  \n",
       "14397       65454  \n",
       "32750        7592  \n",
       "25464       29853  \n",
       "5122          236  \n",
       "24662         360  \n",
       "24660         335  \n",
       "29344         108  \n",
       "24663         381  \n",
       "1766          212  "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mta_entries_exits.sort_values(by='ENTRIES', ascending=False).head(20)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Notice how the Entries is WAAAAAYY too big up until index 5122 \"3 av- 149 st\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>STATION</th>\n",
       "      <th>C/A</th>\n",
       "      <th>UNIT</th>\n",
       "      <th>SCP</th>\n",
       "      <th>DATE</th>\n",
       "      <th>ENTRIES</th>\n",
       "      <th>EXITS</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>5122</th>\n",
       "      <td>3 AV-149 ST</td>\n",
       "      <td>R310</td>\n",
       "      <td>R053</td>\n",
       "      <td>01-00-00</td>\n",
       "      <td>06/25/2020</td>\n",
       "      <td>1691</td>\n",
       "      <td>236</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24662</th>\n",
       "      <td>JAMAICA CENTER</td>\n",
       "      <td>N606</td>\n",
       "      <td>R025</td>\n",
       "      <td>00-00-07</td>\n",
       "      <td>06/25/2020</td>\n",
       "      <td>1679</td>\n",
       "      <td>360</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24660</th>\n",
       "      <td>JAMAICA CENTER</td>\n",
       "      <td>N606</td>\n",
       "      <td>R025</td>\n",
       "      <td>00-00-07</td>\n",
       "      <td>06/23/2020</td>\n",
       "      <td>1678</td>\n",
       "      <td>335</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29344</th>\n",
       "      <td>PARKCHESTER</td>\n",
       "      <td>R417</td>\n",
       "      <td>R222</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/25/2020</td>\n",
       "      <td>1673</td>\n",
       "      <td>108</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24663</th>\n",
       "      <td>JAMAICA CENTER</td>\n",
       "      <td>N606</td>\n",
       "      <td>R025</td>\n",
       "      <td>00-00-07</td>\n",
       "      <td>06/26/2020</td>\n",
       "      <td>1642</td>\n",
       "      <td>381</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1766</th>\n",
       "      <td>14 ST-UNION SQ</td>\n",
       "      <td>A034</td>\n",
       "      <td>R170</td>\n",
       "      <td>03-03-02</td>\n",
       "      <td>06/22/2020</td>\n",
       "      <td>1627</td>\n",
       "      <td>212</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24667</th>\n",
       "      <td>JAMAICA CENTER</td>\n",
       "      <td>N606</td>\n",
       "      <td>R025</td>\n",
       "      <td>00-00-08</td>\n",
       "      <td>06/23/2020</td>\n",
       "      <td>1615</td>\n",
       "      <td>413</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24669</th>\n",
       "      <td>JAMAICA CENTER</td>\n",
       "      <td>N606</td>\n",
       "      <td>R025</td>\n",
       "      <td>00-00-08</td>\n",
       "      <td>06/25/2020</td>\n",
       "      <td>1600</td>\n",
       "      <td>431</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24668</th>\n",
       "      <td>JAMAICA CENTER</td>\n",
       "      <td>N606</td>\n",
       "      <td>R025</td>\n",
       "      <td>00-00-08</td>\n",
       "      <td>06/24/2020</td>\n",
       "      <td>1582</td>\n",
       "      <td>391</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25277</th>\n",
       "      <td>JKSN HT-ROOSVLT</td>\n",
       "      <td>N324</td>\n",
       "      <td>R018</td>\n",
       "      <td>00-03-01</td>\n",
       "      <td>06/24/2020</td>\n",
       "      <td>1571</td>\n",
       "      <td>754</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               STATION   C/A  UNIT       SCP        DATE  ENTRIES  EXITS\n",
       "5122       3 AV-149 ST  R310  R053  01-00-00  06/25/2020     1691    236\n",
       "24662   JAMAICA CENTER  N606  R025  00-00-07  06/25/2020     1679    360\n",
       "24660   JAMAICA CENTER  N606  R025  00-00-07  06/23/2020     1678    335\n",
       "29344      PARKCHESTER  R417  R222  00-00-00  06/25/2020     1673    108\n",
       "24663   JAMAICA CENTER  N606  R025  00-00-07  06/26/2020     1642    381\n",
       "1766    14 ST-UNION SQ  A034  R170  03-03-02  06/22/2020     1627    212\n",
       "24667   JAMAICA CENTER  N606  R025  00-00-08  06/23/2020     1615    413\n",
       "24669   JAMAICA CENTER  N606  R025  00-00-08  06/25/2020     1600    431\n",
       "24668   JAMAICA CENTER  N606  R025  00-00-08  06/24/2020     1582    391\n",
       "25277  JKSN HT-ROOSVLT  N324  R018  00-03-01  06/24/2020     1571    754"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Eliminating rows (turnstiles) with entries greater than 1700\n",
    "cleaned_mta = mta_entries_exits[mta_entries_exits['ENTRIES'] < 1700]\n",
    "cleaned_mta.sort_values(by='ENTRIES', ascending=False).head(10)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This just so happened to work out nicely with \"Exits\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>STATION</th>\n",
       "      <th>C/A</th>\n",
       "      <th>UNIT</th>\n",
       "      <th>SCP</th>\n",
       "      <th>DATE</th>\n",
       "      <th>ENTRIES</th>\n",
       "      <th>EXITS</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>32770</th>\n",
       "      <td>TWENTY THIRD ST</td>\n",
       "      <td>PTH12</td>\n",
       "      <td>R542</td>\n",
       "      <td>00-04-01</td>\n",
       "      <td>06/24/2020</td>\n",
       "      <td>118</td>\n",
       "      <td>3751</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7463</th>\n",
       "      <td>42 ST-PORT AUTH</td>\n",
       "      <td>N063A</td>\n",
       "      <td>R011</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/23/2020</td>\n",
       "      <td>426</td>\n",
       "      <td>3501</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7466</th>\n",
       "      <td>42 ST-PORT AUTH</td>\n",
       "      <td>N063A</td>\n",
       "      <td>R011</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/26/2020</td>\n",
       "      <td>848</td>\n",
       "      <td>3454</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7465</th>\n",
       "      <td>42 ST-PORT AUTH</td>\n",
       "      <td>N063A</td>\n",
       "      <td>R011</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/25/2020</td>\n",
       "      <td>437</td>\n",
       "      <td>3380</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7464</th>\n",
       "      <td>42 ST-PORT AUTH</td>\n",
       "      <td>N063A</td>\n",
       "      <td>R011</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/24/2020</td>\n",
       "      <td>414</td>\n",
       "      <td>3334</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7462</th>\n",
       "      <td>42 ST-PORT AUTH</td>\n",
       "      <td>N063A</td>\n",
       "      <td>R011</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/22/2020</td>\n",
       "      <td>467</td>\n",
       "      <td>3214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1731</th>\n",
       "      <td>14 ST-UNION SQ</td>\n",
       "      <td>A034</td>\n",
       "      <td>R170</td>\n",
       "      <td>03-00-00</td>\n",
       "      <td>06/22/2020</td>\n",
       "      <td>341</td>\n",
       "      <td>2595</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7472</th>\n",
       "      <td>42 ST-PORT AUTH</td>\n",
       "      <td>N063A</td>\n",
       "      <td>R011</td>\n",
       "      <td>00-00-01</td>\n",
       "      <td>06/25/2020</td>\n",
       "      <td>698</td>\n",
       "      <td>2526</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7473</th>\n",
       "      <td>42 ST-PORT AUTH</td>\n",
       "      <td>N063A</td>\n",
       "      <td>R011</td>\n",
       "      <td>00-00-01</td>\n",
       "      <td>06/26/2020</td>\n",
       "      <td>1189</td>\n",
       "      <td>2511</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7471</th>\n",
       "      <td>42 ST-PORT AUTH</td>\n",
       "      <td>N063A</td>\n",
       "      <td>R011</td>\n",
       "      <td>00-00-01</td>\n",
       "      <td>06/24/2020</td>\n",
       "      <td>710</td>\n",
       "      <td>2483</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7469</th>\n",
       "      <td>42 ST-PORT AUTH</td>\n",
       "      <td>N063A</td>\n",
       "      <td>R011</td>\n",
       "      <td>00-00-01</td>\n",
       "      <td>06/22/2020</td>\n",
       "      <td>713</td>\n",
       "      <td>2482</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7470</th>\n",
       "      <td>42 ST-PORT AUTH</td>\n",
       "      <td>N063A</td>\n",
       "      <td>R011</td>\n",
       "      <td>00-00-01</td>\n",
       "      <td>06/23/2020</td>\n",
       "      <td>703</td>\n",
       "      <td>2479</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25513</th>\n",
       "      <td>JUNCTION BLVD</td>\n",
       "      <td>R528</td>\n",
       "      <td>R097</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/22/2020</td>\n",
       "      <td>544</td>\n",
       "      <td>2157</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25514</th>\n",
       "      <td>JUNCTION BLVD</td>\n",
       "      <td>R528</td>\n",
       "      <td>R097</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/23/2020</td>\n",
       "      <td>560</td>\n",
       "      <td>2120</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28673</th>\n",
       "      <td>NEWARK HM HE</td>\n",
       "      <td>PTH20</td>\n",
       "      <td>R549</td>\n",
       "      <td>03-01-07</td>\n",
       "      <td>06/26/2020</td>\n",
       "      <td>4</td>\n",
       "      <td>2114</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25515</th>\n",
       "      <td>JUNCTION BLVD</td>\n",
       "      <td>R528</td>\n",
       "      <td>R097</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/24/2020</td>\n",
       "      <td>600</td>\n",
       "      <td>2067</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25516</th>\n",
       "      <td>JUNCTION BLVD</td>\n",
       "      <td>R528</td>\n",
       "      <td>R097</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/25/2020</td>\n",
       "      <td>608</td>\n",
       "      <td>2063</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28671</th>\n",
       "      <td>NEWARK HM HE</td>\n",
       "      <td>PTH20</td>\n",
       "      <td>R549</td>\n",
       "      <td>03-01-07</td>\n",
       "      <td>06/24/2020</td>\n",
       "      <td>4</td>\n",
       "      <td>2056</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23004</th>\n",
       "      <td>GRD CNTRL-42 ST</td>\n",
       "      <td>R240</td>\n",
       "      <td>R047</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/26/2020</td>\n",
       "      <td>346</td>\n",
       "      <td>2029</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23002</th>\n",
       "      <td>GRD CNTRL-42 ST</td>\n",
       "      <td>R240</td>\n",
       "      <td>R047</td>\n",
       "      <td>00-00-00</td>\n",
       "      <td>06/24/2020</td>\n",
       "      <td>500</td>\n",
       "      <td>2000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               STATION    C/A  UNIT       SCP        DATE  ENTRIES  EXITS\n",
       "32770  TWENTY THIRD ST  PTH12  R542  00-04-01  06/24/2020      118   3751\n",
       "7463   42 ST-PORT AUTH  N063A  R011  00-00-00  06/23/2020      426   3501\n",
       "7466   42 ST-PORT AUTH  N063A  R011  00-00-00  06/26/2020      848   3454\n",
       "7465   42 ST-PORT AUTH  N063A  R011  00-00-00  06/25/2020      437   3380\n",
       "7464   42 ST-PORT AUTH  N063A  R011  00-00-00  06/24/2020      414   3334\n",
       "7462   42 ST-PORT AUTH  N063A  R011  00-00-00  06/22/2020      467   3214\n",
       "1731    14 ST-UNION SQ   A034  R170  03-00-00  06/22/2020      341   2595\n",
       "7472   42 ST-PORT AUTH  N063A  R011  00-00-01  06/25/2020      698   2526\n",
       "7473   42 ST-PORT AUTH  N063A  R011  00-00-01  06/26/2020     1189   2511\n",
       "7471   42 ST-PORT AUTH  N063A  R011  00-00-01  06/24/2020      710   2483\n",
       "7469   42 ST-PORT AUTH  N063A  R011  00-00-01  06/22/2020      713   2482\n",
       "7470   42 ST-PORT AUTH  N063A  R011  00-00-01  06/23/2020      703   2479\n",
       "25513    JUNCTION BLVD   R528  R097  00-00-00  06/22/2020      544   2157\n",
       "25514    JUNCTION BLVD   R528  R097  00-00-00  06/23/2020      560   2120\n",
       "28673     NEWARK HM HE  PTH20  R549  03-01-07  06/26/2020        4   2114\n",
       "25515    JUNCTION BLVD   R528  R097  00-00-00  06/24/2020      600   2067\n",
       "25516    JUNCTION BLVD   R528  R097  00-00-00  06/25/2020      608   2063\n",
       "28671     NEWARK HM HE  PTH20  R549  03-01-07  06/24/2020        4   2056\n",
       "23004  GRD CNTRL-42 ST   R240  R047  00-00-00  06/26/2020      346   2029\n",
       "23002  GRD CNTRL-42 ST   R240  R047  00-00-00  06/24/2020      500   2000"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cleaned_mta.sort_values(by='EXITS', ascending=False).head(20)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 4. Accumulated sum by Station"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ENTRIES</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>STATION</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>34 ST-PENN STA</th>\n",
       "      <td>111737</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125 ST</th>\n",
       "      <td>99982</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34 ST-HERALD SQ</th>\n",
       "      <td>89962</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42 ST-PORT AUTH</th>\n",
       "      <td>86315</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>86 ST</th>\n",
       "      <td>83931</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14 ST-UNION SQ</th>\n",
       "      <td>78572</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GRD CNTRL-42 ST</th>\n",
       "      <td>76265</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>JKSN HT-ROOSVLT</th>\n",
       "      <td>76162</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23 ST</th>\n",
       "      <td>75402</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>FLUSHING-MAIN</th>\n",
       "      <td>72964</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 ENTRIES\n",
       "STATION                 \n",
       "34 ST-PENN STA    111737\n",
       "125 ST             99982\n",
       "34 ST-HERALD SQ    89962\n",
       "42 ST-PORT AUTH    86315\n",
       "86 ST              83931\n",
       "14 ST-UNION SQ     78572\n",
       "GRD CNTRL-42 ST    76265\n",
       "JKSN HT-ROOSVLT    76162\n",
       "23 ST              75402\n",
       "FLUSHING-MAIN      72964"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# This is the accumulated Entries by station\n",
    "total_by_station = cleaned_mta.groupby('STATION')[['ENTRIES']].sum()\n",
    "total_by_station.sort_values(by=['ENTRIES'], ascending=False).head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ENTRIES</th>\n",
       "      <th>EXITS</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>STATION</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>34 ST-PENN STA</th>\n",
       "      <td>111737</td>\n",
       "      <td>143196</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125 ST</th>\n",
       "      <td>99982</td>\n",
       "      <td>130739</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34 ST-HERALD SQ</th>\n",
       "      <td>89962</td>\n",
       "      <td>110038</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>86 ST</th>\n",
       "      <td>83931</td>\n",
       "      <td>104791</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GRD CNTRL-42 ST</th>\n",
       "      <td>76265</td>\n",
       "      <td>102057</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14 ST-UNION SQ</th>\n",
       "      <td>78572</td>\n",
       "      <td>99616</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42 ST-PORT AUTH</th>\n",
       "      <td>86315</td>\n",
       "      <td>95779</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23 ST</th>\n",
       "      <td>75402</td>\n",
       "      <td>82166</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>FULTON ST</th>\n",
       "      <td>68937</td>\n",
       "      <td>80819</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59 ST</th>\n",
       "      <td>66368</td>\n",
       "      <td>75318</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 ENTRIES   EXITS\n",
       "STATION                         \n",
       "34 ST-PENN STA    111737  143196\n",
       "125 ST             99982  130739\n",
       "34 ST-HERALD SQ    89962  110038\n",
       "86 ST              83931  104791\n",
       "GRD CNTRL-42 ST    76265  102057\n",
       "14 ST-UNION SQ     78572   99616\n",
       "42 ST-PORT AUTH    86315   95779\n",
       "23 ST              75402   82166\n",
       "FULTON ST          68937   80819\n",
       "59 ST              66368   75318"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# ... and now we'll add the total exits \n",
    "total_by_station['EXITS'] = cleaned_mta.groupby('STATION')[['EXITS']].sum()\n",
    "\n",
    "# so we can see both columns and sort by exits now\n",
    "total_by_station.sort_values(by=['EXITS'], ascending=False).head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ENTRIES</th>\n",
       "      <th>EXITS</th>\n",
       "      <th>BOTH</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>STATION</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>34 ST-PENN STA</th>\n",
       "      <td>111737</td>\n",
       "      <td>143196</td>\n",
       "      <td>254933</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125 ST</th>\n",
       "      <td>99982</td>\n",
       "      <td>130739</td>\n",
       "      <td>230721</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34 ST-HERALD SQ</th>\n",
       "      <td>89962</td>\n",
       "      <td>110038</td>\n",
       "      <td>200000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>86 ST</th>\n",
       "      <td>83931</td>\n",
       "      <td>104791</td>\n",
       "      <td>188722</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42 ST-PORT AUTH</th>\n",
       "      <td>86315</td>\n",
       "      <td>95779</td>\n",
       "      <td>182094</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GRD CNTRL-42 ST</th>\n",
       "      <td>76265</td>\n",
       "      <td>102057</td>\n",
       "      <td>178322</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14 ST-UNION SQ</th>\n",
       "      <td>78572</td>\n",
       "      <td>99616</td>\n",
       "      <td>178188</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23 ST</th>\n",
       "      <td>75402</td>\n",
       "      <td>82166</td>\n",
       "      <td>157568</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>FULTON ST</th>\n",
       "      <td>68937</td>\n",
       "      <td>80819</td>\n",
       "      <td>149756</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>FLUSHING-MAIN</th>\n",
       "      <td>72964</td>\n",
       "      <td>75181</td>\n",
       "      <td>148145</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 ENTRIES   EXITS    BOTH\n",
       "STATION                                 \n",
       "34 ST-PENN STA    111737  143196  254933\n",
       "125 ST             99982  130739  230721\n",
       "34 ST-HERALD SQ    89962  110038  200000\n",
       "86 ST              83931  104791  188722\n",
       "42 ST-PORT AUTH    86315   95779  182094\n",
       "GRD CNTRL-42 ST    76265  102057  178322\n",
       "14 ST-UNION SQ     78572   99616  178188\n",
       "23 ST              75402   82166  157568\n",
       "FULTON ST          68937   80819  149756\n",
       "FLUSHING-MAIN      72964   75181  148145"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_by_station['BOTH'] = total_by_station.ENTRIES + total_by_station.EXITS\n",
    "total_by_station.sort_values(by=['BOTH'], ascending=False).head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Our separate attempt at the table including time"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "## gets the number of entries and exits\n",
    "mta_entries_wT = df.groupby(['STATION','C/A','UNIT','SCP','DATE', 'TIME']).ENTRIES.max() - df.groupby(['STATION','C/A','UNIT','SCP','DATE', 'TIME']).ENTRIES.min()\n",
    "mta_exits_wT = df.groupby(['STATION','C/A','UNIT','SCP','DATE', 'TIME']).EXITS.max() - df.groupby(['STATION','C/A','UNIT','SCP','DATE', 'TIME']).EXITS.min()\n",
    "\n",
    "## flattens the data\n",
    "mta_entries_flat_wT = mta_entries_wT.reset_index()\n",
    "mta_exits_flat_wT = mta_exits_wT.reset_index()\n",
    "mta_entries_exits_wT = pd.merge(mta_entries_flat_wT, mta_exits_flat_wT, how='outer')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Other useful commands (don't run)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.iloc[x:y] # to view rows x to y-1 of df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# insert percentile here."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
